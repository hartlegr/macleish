---
title: "Cow Camp & Woods Romp: A New Camping Experience"
output: 
  html_document:
    code_folding: hide
    theme: cosmo

---

^[https://github.com/hartlegr/macleish]


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library(sf)
library(macleish)

```



![](https://www.kestreltrust.org/wp-content/uploads/2016/09/MacLeish-panoram-Reid-BertoneJohnson-e1474896225961.jpg)





```{r}
library(leaflet)

base_plot <- leaflet() %>%
  addTiles() %>%
#  addPolylines(data = pluck(macleish_layers, "streams")) %>%
  addPolylines(data = pluck(macleish_layers, "boundary"), col = "black", weight = 3)%>%
  #addPolygons(data = pluck(macleish_layers, "forests"))%>%
#  addPolylines(data = pluck(macleish_layers, "trails"), col = "green")%>%
#  addMarkers(data = pluck(macleish_layers, "challenge_courses"), popup = ~cmt)%>%
#  addPolygons(data = pluck(macleish_layers, "research"), col = "orange")%>%
  addPolygons(data = pluck(macleish_layers, "wetlands"), col = "red", weight = 2)
 
```


#Markers for campsites, research, and parking:
```{r}
camp_plot <- 
  base_plot %>% 
addMarkers(lng = -72.678154, lat =  42.450976, popup = "Group Campsite") %>%
 addMarkers(lng = -72.679581, lat = 42.458549, popup = "Remote Campsite") %>%
 addMarkers(lng = -72.680663, lat = 42.448013, popup = "Parking")%>%
 addMarkers(lng = -72.680315, lat = 42.449653, popup = "OrchardMet Weather Station")%>%
 addMarkers(lng = -72.680553, lat = 42.448470, popup = "WhatelyMet Weather Station")

camp_plot


```


#Add circle around parking lot with a 0.5 mile radius:
```{r}
parking_buffer <- base_plot %>%
  addCircles(lng = -72.680663 , lat = 42.448013, weight = 1,
    radius = 804)

parking_buffer

```


```{r}
proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"


```


```{r}
stream_buffer <- macleish_layers %>%
  pluck("streams") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 200) %>%
  st_transform(4326)

```


```{r}
research_buffer <- macleish_layers %>%
  pluck("research")%>%
  st_transform(proj4_aea)%>%
  st_buffer(dist = 500) %>%
  st_transform(4326)
```

```{r}
challenge_buffer <- macleish_layers %>% 
  pluck("challenge_courses")%>%
  st_transform(proj4_aea)%>%
  st_buffer(dist = 500)%>%
  st_transform(4326)
```

#Mapped vegetation types:
```{r}
forests1 <- macleish_layers%>%
  pluck("forests")%>%
  filter(!is.na(VegType_21))%>%
  group_by(VegType_21)%>%
  summarize(N = n())

```

```{r}
pal <- colorNumeric(
  palette = "inferno", 
  domain = forests1$VegType_21
)
```

```{r}
treeplot <- base_plot%>%
  addPolygons(data = forests1, color = ~pal(VegType_21), weight = 1)

treeplot
```

#Buffer from streams:
```{r}
base_plot %>%
  addPolygons(data = stream_buffer)%>%
  addMarkers(lng = -72.679210, lat =  42.444697, popup = "Proposed Site 1")%>%
  addMarkers(lng = -72.683844, lat =  42.455057, popup = "Proposed Site 2")

```

```{r}
  cowIcon <- makeIcon(iconUrl = "http://icons.iconarchive.com/icons/iconsmind/outline/128/Cow-icon.png", iconWidth = 35, iconHeight = 40)

TreeIcon <- makeIcon(iconUrl = "http://icons.iconarchive.com/icons/iconsmind/outline/128/Tree-3-icon.png", iconWidth = 40, iconHeight = 40)
```


#Campsites with vegetation type:
```{r}
treeplot %>%
  addMarkers(lng = -72.679210, lat =  42.444697, popup = "Cow Camp", icon = cowIcon)%>%
  addMarkers(lng = -72.683844, lat =  42.455057, popup = "Woods Romp", icon = TreeIcon)

```




#Contours:
```{r}
base_plot%>%
  addMarkers(lng = -72.679210, lat =  42.444697, popup = "Cow Camp", icon = cowIcon)%>%
  addMarkers(lng = -72.683844, lat =  42.455057, popup = "Woods Romp", icon = TreeIcon)%>%
  addPolygons(data = pluck(macleish_layers, "contours_3m"), col = "red", weight = 0.5)
  

```