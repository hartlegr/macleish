---
title: "mini_proj3"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(sf)
library(macleish)

```

This is code from his lecture on 4/3 that may be helpful?
```{r}


macleish_layers %>%
  pluck("streams") %>%
  st_transform(I don't know what to put here) %>%
  st_buffer(dist = 10) %>%
  st_transform(4326)
```

```{r}
ggplot()+
  geom_sf(data =macleish_layers[["boundary"]]) +
  geom_sf(data =macleish_layers[["trails"]], col = "green") +
  geom_sf(data =macleish_layers[["forests"]]) +
  geom_sf(data =macleish_layers[["streams"]], col = "blue") + 
  geom_sf(data =macleish_layers[["challenge_courses"]], fill = "orange") + 
  geom_sf(data =macleish_layers[["research"]], fill = "orange")+
  geom_sf(data =macleish_layers[["contours_30ft"]], col="red") + 
  geom_sf(data =macleish_layers[["wetlands"]], fill = "yellow") 
  
```


```{r}


st_as_sf(macleish_layers) %>% st_transform(3488)

macleish_layers %>%
  pluck("streams") %>%
  st_buffer(dist = 0.1)
```


```{r}
library(leaflet)

base_plot <- leaflet() %>%
  addTiles() %>%
  addPolylines(data = pluck(macleish_layers, "streams")) %>%
  addPolylines(data = pluck(macleish_layers, "boundary"), col = "red")%>%
  #addPolygons(data = pluck(macleish_layers, "forests"))%>%
  addPolylines(data = pluck(macleish_layers, "trails"), col = "green")%>%
  addMarkers(data = pluck(macleish_layers, "challenge_courses"), popup = ~cmt)%>%
  addPolygons(data = pluck(macleish_layers, "research"), col = "orange")%>%
  addPolygons(data = pluck(macleish_layers, "wetlands"), col = "red")%>%
  #addPolygons(data = pluck(macleish_layers, "contours_30ft"))%>%
  addMarkers(lng = -72.678154, lat =  42.450976, popup = "Group Campsite") %>%
  addMarkers(lng = -72.679581, lat = 42.458549, popup = "Remote Campsite") %>%
  addMarkers(lng = -72.680663, lat = 42.448013, popup = "Parking")%>%
  addMarkers(lng = -72.680315, lat = 42.449653, popup = "OrchardMet Weather Station")%>%
  addMarkers(lng = -72.680553, lat = 42.448470, popup = "WhatelyMet Weather Station")

```

```{r}
proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"


```

```{r}
stream_buffer <- macleish_layers %>%
  pluck("streams") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 200) %>%
  st_transform(4326)

```


```{r}
base_plot %>%
  addPolygons(data = stream_buffer, col = "gray")
```



```{r}
parking_buffer <- 
  st_transform(proj4_aea) %>%
  st_buffer(dist = 200) %>%
  st_transform(4326)
```


